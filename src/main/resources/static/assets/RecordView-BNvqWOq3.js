import{r as c,a as d,e as k,b as e,q as m,v as p,h,F as _,b6 as y,t as w,k as R,o as i}from"./index-DBgGMAVP.js";import{H as C}from"./Header-gOfElMZz.js";import{r as g}from"./record-BH2DDIe9.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-D-v-8tSO.js";const I={class:"relative flex min-h-screen w-full flex-col"},V={class:"flex-grow"},U={class:"container mx-auto px-4 py-8 max-w-4xl"},j={class:"bg-card-dark rounded-xl p-6 mb-6"},A={class:"mb-4"},B={class:"mb-4"},D={class:"mb-4"},F={key:0,class:"mt-4 grid grid-cols-3 gap-4"},N=["src"],E=["onClick"],H={class:"flex justify-end"},L=["disabled"],G={__name:"RecordView",setup(q){const b=R(),s=c({title:"",content:"",planId:null}),o=c([]),n=c(!1),f=a=>{Array.from(a.target.files).forEach(l=>{const r=new FileReader;r.onload=u=>{o.value.push(u.target.result)},r.readAsDataURL(l)})},v=a=>{o.value.splice(a,1)},x=async()=>{if(!s.value.title||!s.value.content){alert("제목과 내용을 입력해주세요");return}n.value=!0;try{let a=[];if(o.value.length>0){const l=await g.uploadRecordImages(o.value);l.success&&(a=l.data||[])}const t=await g.createRecord({title:s.value.title,content:s.value.content,planId:s.value.planId,images:a});t.success?(alert("여행 기록이 작성되었습니다"),b.push("/my-records")):alert(t.message||"여행 기록 작성에 실패했습니다")}catch(a){console.error("여행 기록 작성 오류:",a),alert("여행 기록 작성 중 오류가 발생했습니다")}finally{n.value=!1}};return(a,t)=>(i(),d("div",I,[k(C),e("main",V,[e("div",U,[t[5]||(t[5]=e("h1",{class:"text-3xl font-bold text-text-dark mb-6"},"새 여행 기록 작성",-1)),e("div",j,[e("div",A,[t[2]||(t[2]=e("label",{class:"block text-sm font-medium text-text-secondary-dark mb-2"},"제목",-1)),m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>s.value.title=l),class:"w-full bg-background-dark text-text-dark rounded-lg p-3",placeholder:"여행 기록 제목을 입력하세요"},null,512),[[p,s.value.title]])]),e("div",B,[t[3]||(t[3]=e("label",{class:"block text-sm font-medium text-text-secondary-dark mb-2"},"내용",-1)),m(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=l=>s.value.content=l),class:"w-full bg-background-dark text-text-dark rounded-lg p-3",rows:"10",placeholder:"여행 기록을 작성하세요"},null,512),[[p,s.value.content]])]),e("div",D,[t[4]||(t[4]=e("label",{class:"block text-sm font-medium text-text-secondary-dark mb-2"},"이미지",-1)),e("input",{type:"file",onChange:f,accept:"image/*",multiple:"",class:"w-full bg-background-dark text-text-dark rounded-lg p-3"},null,32),o.value.length>0?(i(),d("div",F,[(i(!0),d(_,null,y(o.value,(l,r)=>(i(),d("div",{key:r,class:"relative"},[e("img",{src:l,class:"w-full h-32 object-cover rounded-lg"},null,8,N),e("button",{onClick:u=>v(r),class:"absolute top-2 right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center"},"×",8,E)]))),128))])):h("",!0)])]),e("div",H,[e("button",{onClick:x,disabled:n.value,class:"px-8 py-3 bg-primary text-white rounded-lg font-bold hover:bg-blue-500 disabled:opacity-50"},w(n.value?"게시 중...":"게시하기"),9,L)])])])]))}};export{G as default};
